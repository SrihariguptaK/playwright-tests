[
  {
    "storyId": "story-14",
    "storyTitle": "As Manager, I want to configure approval workflows to achieve compliant and flexible schedule change approvals",
    "testCases": [
      {
        "id": "tc-001",
        "title": "Validate creation of multi-level approval workflow",
        "type": "happy-path",
        "priority": "High",
        "preconditions": [
          "Manager user account exists with workflow configuration permissions",
          "Manager is logged into the admin portal",
          "ApprovalWorkflows and WorkflowRules tables are accessible",
          "At least two potential approvers exist in the system"
        ],
        "steps": [
          {
            "step": 1,
            "action": "Manager navigates to workflow configuration page from the admin portal menu",
            "expectedResult": "Workflow configuration UI is displayed with options to create new workflow, view existing workflows, and configure workflow settings"
          },
          {
            "step": 2,
            "action": "Manager clicks 'Create New Workflow' button",
            "expectedResult": "Workflow creation form is displayed with fields for workflow name, description, and approval levels"
          },
          {
            "step": 3,
            "action": "Manager enters workflow name 'Schedule Change Approval - Level 2' and description 'Two-level approval for schedule changes'",
            "expectedResult": "Workflow name and description are accepted and displayed in the form fields"
          },
          {
            "step": 4,
            "action": "Manager adds first approval level by selecting 'Add Level' and assigns 'Team Lead' as Level 1 approver",
            "expectedResult": "Level 1 approval is created and displayed with 'Team Lead' assigned as approver"
          },
          {
            "step": 5,
            "action": "Manager adds second approval level by selecting 'Add Level' and assigns 'Department Manager' as Level 2 approver",
            "expectedResult": "Level 2 approval is created and displayed with 'Department Manager' assigned as approver, showing hierarchy: Level 1 → Level 2"
          },
          {
            "step": 6,
            "action": "Manager clicks 'Save' button to save the workflow configuration",
            "expectedResult": "Success message is displayed confirming 'Workflow saved successfully' and workflow appears in the workflow list with status 'Active'"
          },
          {
            "step": 7,
            "action": "Manager navigates to the audit log section and filters by workflow configuration changes",
            "expectedResult": "Audit log entry is displayed showing workflow creation with workflow name, creation timestamp, manager username, and action type 'CREATE'"
          }
        ],
        "postconditions": [
          "New multi-level workflow is saved in ApprovalWorkflows table",
          "Workflow is visible in the workflow list",
          "Audit log contains complete record of workflow creation",
          "Workflow is available for assignment to schedule change types"
        ],
        "estimatedTime": "8 mins"
      },
      {
        "id": "tc-002",
        "title": "Verify rejection of invalid workflow configuration",
        "type": "error-case",
        "priority": "High",
        "preconditions": [
          "Manager user account exists with workflow configuration permissions",
          "Manager is logged into the admin portal",
          "Workflow configuration page is accessible",
          "System validation rules are active"
        ],
        "steps": [
          {
            "step": 1,
            "action": "Manager navigates to workflow configuration page and clicks 'Create New Workflow'",
            "expectedResult": "Workflow creation form is displayed"
          },
          {
            "step": 2,
            "action": "Manager enters workflow name 'Invalid Circular Workflow' and creates Level 1 approver as 'Manager A'",
            "expectedResult": "Level 1 is created with 'Manager A' as approver"
          },
          {
            "step": 3,
            "action": "Manager creates Level 2 approver as 'Manager B' with escalation back to 'Manager A'",
            "expectedResult": "Level 2 is created with 'Manager B' as approver and escalation path configured"
          },
          {
            "step": 4,
            "action": "Manager creates Level 3 approver as 'Manager A', creating a circular hierarchy (Manager A → Manager B → Manager A)",
            "expectedResult": "Level 3 is created with 'Manager A' selected"
          },
          {
            "step": 5,
            "action": "Manager clicks 'Save' button to attempt saving the workflow",
            "expectedResult": "Validation error message is displayed: 'Invalid workflow configuration: Circular approval hierarchy detected. Approver cannot appear multiple times in the approval chain.' Save operation is prevented and workflow is not saved"
          },
          {
            "step": 6,
            "action": "Manager removes Level 3 from the workflow configuration",
            "expectedResult": "Level 3 is removed and workflow now shows only Level 1 (Manager A) → Level 2 (Manager B)"
          },
          {
            "step": 7,
            "action": "Manager clicks 'Save' button again to save the corrected workflow",
            "expectedResult": "Success message is displayed: 'Workflow saved successfully' and workflow appears in the workflow list with valid configuration"
          }
        ],
        "postconditions": [
          "Invalid workflow with circular hierarchy is not saved in the database",
          "Corrected workflow is successfully saved in ApprovalWorkflows table",
          "System validation rules prevented data corruption",
          "Audit log shows attempted save and successful save of corrected workflow"
        ],
        "estimatedTime": "7 mins"
      },
      {
        "id": "tc-003",
        "title": "Test role-based access control for workflow configuration",
        "type": "error-case",
        "priority": "High",
        "preconditions": [
          "Two user accounts exist: one unauthorized user (Employee role) and one authorized manager (Manager role)",
          "Role-based access control is configured and active",
          "Workflow configuration page requires Manager role or higher",
          "Both users have valid login credentials"
        ],
        "steps": [
          {
            "step": 1,
            "action": "Unauthorized user (Employee role) logs into the system with valid credentials",
            "expectedResult": "User is successfully logged in and redirected to employee dashboard"
          },
          {
            "step": 2,
            "action": "Unauthorized user attempts to navigate to workflow configuration page by entering the URL directly or clicking menu option (if visible)",
            "expectedResult": "Access is denied with error message: 'Access Denied: You do not have permission to access workflow configuration. Please contact your administrator.' User is redirected to their dashboard or error page"
          },
          {
            "step": 3,
            "action": "Unauthorized user logs out of the system",
            "expectedResult": "User is successfully logged out and redirected to login page"
          },
          {
            "step": 4,
            "action": "Authorized manager logs into the admin portal with valid manager credentials",
            "expectedResult": "Manager is successfully logged in and redirected to admin dashboard"
          },
          {
            "step": 5,
            "action": "Authorized manager navigates to workflow configuration page from the admin menu",
            "expectedResult": "Access is granted and workflow configuration UI is displayed with full functionality including create, edit, and delete options"
          },
          {
            "step": 6,
            "action": "Manager verifies all workflow configuration features are accessible (create, edit, view, delete)",
            "expectedResult": "All workflow configuration features are available and functional for the authorized manager"
          }
        ],
        "postconditions": [
          "Unauthorized user access attempt is logged in security audit log",
          "Authorized manager has full access to workflow configuration",
          "Role-based access control is functioning correctly",
          "No unauthorized changes were made to workflow configurations"
        ],
        "estimatedTime": "6 mins"
      }
    ]
  },
  {
    "storyId": "story-20",
    "storyTitle": "As System Administrator, I want to manage user roles and permissions for schedule change approval workflows to ensure secure access",
    "testCases": [
      {
        "id": "tc-004",
        "title": "Create and assign user roles successfully",
        "type": "happy-path",
        "priority": "High",
        "preconditions": [
          "System Administrator account exists with full role management permissions",
          "Administrator is logged into the admin portal",
          "UserRoles and Permissions tables are accessible",
          "At least one user account exists for role assignment",
          "Audit logging system is active"
        ],
        "steps": [
          {
            "step": 1,
            "action": "Administrator navigates to user management section from the admin portal main menu",
            "expectedResult": "User management dashboard is displayed showing options for role management, user management, and permissions"
          },
          {
            "step": 2,
            "action": "Administrator clicks on 'Role Management' tab or menu option",
            "expectedResult": "Role management interface is displayed showing existing roles list and 'Create New Role' button"
          },
          {
            "step": 3,
            "action": "Administrator clicks 'Create New Role' button",
            "expectedResult": "Role creation form is displayed with fields for role name, description, and permissions checkboxes"
          },
          {
            "step": 4,
            "action": "Administrator enters role name 'Schedule Approver' and description 'Can approve schedule change requests'",
            "expectedResult": "Role name and description are accepted and displayed in the form fields"
          },
          {
            "step": 5,
            "action": "Administrator selects specific permissions: 'View Schedule Requests', 'Approve Schedule Requests', and 'Reject Schedule Requests' from the permissions list",
            "expectedResult": "Selected permissions are checked and highlighted in the permissions list"
          },
          {
            "step": 6,
            "action": "Administrator clicks 'Save Role' button",
            "expectedResult": "Success message is displayed: 'Role created successfully' and the new role 'Schedule Approver' appears in the role list with assigned permissions visible"
          },
          {
            "step": 7,
            "action": "Administrator navigates to 'User Management' section and selects a user 'John Doe' from the user list",
            "expectedResult": "User details page is displayed showing current roles and option to assign new roles"
          },
          {
            "step": 8,
            "action": "Administrator clicks 'Assign Role' button and selects 'Schedule Approver' role from the dropdown",
            "expectedResult": "Role selection dropdown displays available roles including the newly created 'Schedule Approver' role"
          },
          {
            "step": 9,
            "action": "Administrator confirms the role assignment by clicking 'Assign' button",
            "expectedResult": "Success message is displayed: 'Role assigned successfully' and 'Schedule Approver' role appears in user's assigned roles list with immediate effect indicator"
          },
          {
            "step": 10,
            "action": "Administrator verifies the role is effective by checking user permissions or having user test access",
            "expectedResult": "User 'John Doe' immediately has access to schedule approval functions without requiring re-login"
          },
          {
            "step": 11,
            "action": "Administrator navigates to audit log section and filters by role management activities",
            "expectedResult": "Audit log displays two entries: 1) Role creation for 'Schedule Approver' with timestamp, administrator username, and action details, 2) Role assignment to 'John Doe' with timestamp, administrator username, role name, and user details"
          }
        ],
        "postconditions": [
          "New role 'Schedule Approver' is saved in UserRoles table",
          "Role permissions are stored in Permissions table",
          "User 'John Doe' has 'Schedule Approver' role assigned",
          "Role assignment is effective immediately",
          "Complete audit trail exists for both role creation and assignment",
          "User can perform actions according to assigned permissions"
        ],
        "estimatedTime": "10 mins"
      },
      {
        "id": "tc-005",
        "title": "Prevent unauthorized access to role management",
        "type": "error-case",
        "priority": "High",
        "preconditions": [
          "Non-administrator user account exists (e.g., Employee or Manager role without admin privileges)",
          "User has valid login credentials",
          "Role management access is restricted to Administrator role only",
          "Authentication and authorization systems are active"
        ],
        "steps": [
          {
            "step": 1,
            "action": "Non-administrator user logs into the system with valid credentials",
            "expectedResult": "User is successfully authenticated and redirected to their appropriate dashboard based on their role"
          },
          {
            "step": 2,
            "action": "Non-administrator user attempts to access role management UI by entering the direct URL '/admin/role-management' in the browser",
            "expectedResult": "Access is denied and error page is displayed with message: 'Access Denied: You do not have sufficient privileges to access role management. This function is restricted to System Administrators only.'"
          },
          {
            "step": 3,
            "action": "Non-administrator user checks their navigation menu for role management options",
            "expectedResult": "Role management menu option is not visible in the user's navigation menu"
          },
          {
            "step": 4,
            "action": "Non-administrator user attempts to access role management via API endpoint using browser developer tools or API client",
            "expectedResult": "API returns 403 Forbidden status code with error message: 'Unauthorized access. Administrator privileges required.'"
          },
          {
            "step": 5,
            "action": "System logs the unauthorized access attempt",
            "expectedResult": "Security audit log records the unauthorized access attempt with user details, timestamp, attempted resource, and denial reason"
          }
        ],
        "postconditions": [
          "No unauthorized access to role management was granted",
          "User roles and permissions remain unchanged",
          "Security audit log contains record of access denial",
          "System security integrity is maintained",
          "No sensitive role or permission data was exposed"
        ],
        "estimatedTime": "5 mins"
      },
      {
        "id": "tc-006",
        "title": "Validate role and permission consistency",
        "type": "error-case",
        "priority": "High",
        "preconditions": [
          "System Administrator is logged into the admin portal",
          "Role management interface is accessible",
          "Permission validation rules are configured and active",
          "System has predefined conflicting permission rules (e.g., 'Submit Request' conflicts with 'Final Approval')"
        ],
        "steps": [
          {
            "step": 1,
            "action": "Administrator navigates to role management section and clicks 'Create New Role'",
            "expectedResult": "Role creation form is displayed with permissions list"
          },
          {
            "step": 2,
            "action": "Administrator enters role name 'Conflicting Role Test' and description 'Testing permission conflict validation'",
            "expectedResult": "Role name and description are accepted in the form"
          },
          {
            "step": 3,
            "action": "Administrator selects permission 'Submit Schedule Change Request' from the permissions list",
            "expectedResult": "Permission 'Submit Schedule Change Request' is checked and highlighted"
          },
          {
            "step": 4,
            "action": "Administrator attempts to also select conflicting permission 'Final Approval Authority' which conflicts with submission permission based on separation of duties principle",
            "expectedResult": "Warning message is displayed: 'Permission conflict detected: Users with submission rights cannot have final approval authority due to separation of duties policy.' The conflicting permission is either not selectable or highlighted in red"
          },
          {
            "step": 5,
            "action": "Administrator ignores warning (if allowed) and clicks 'Save Role' button with both conflicting permissions selected",
            "expectedResult": "Validation error is displayed: 'Cannot save role: Conflicting permissions detected. Please review and remove conflicting permissions: Submit Schedule Change Request and Final Approval Authority cannot be assigned to the same role.' Save operation is prevented and role is not created"
          },
          {
            "step": 6,
            "action": "Administrator deselects 'Final Approval Authority' permission, leaving only 'Submit Schedule Change Request' selected",
            "expectedResult": "Conflict warning disappears and form shows valid state"
          },
          {
            "step": 7,
            "action": "Administrator clicks 'Save Role' button with valid permission set",
            "expectedResult": "Success message is displayed: 'Role created successfully' and role appears in the role list with only the valid, non-conflicting permissions"
          }
        ],
        "postconditions": [
          "Role with conflicting permissions was not saved to database",
          "Role with valid permissions was successfully created",
          "Permission consistency rules are enforced",
          "Audit log shows validation failure and successful creation attempts",
          "Data integrity is maintained in UserRoles and Permissions tables"
        ],
        "estimatedTime": "7 mins"
      }
    ]
  },
  {
    "storyId": "story-22",
    "storyTitle": "As System Administrator, I want to audit all schedule change approval workflow activities to ensure compliance and traceability",
    "testCases": [
      {
        "id": "tc-001",
        "title": "Verify logging of schedule change workflow activities",
        "type": "happy-path",
        "priority": "High",
        "preconditions": [
          "System Administrator is logged in with valid credentials",
          "Administrator has audit log access permissions",
          "AuditLogs table is accessible and operational",
          "At least one schedule change workflow exists in the system",
          "Audit logging service is enabled and running"
        ],
        "steps": [
          {
            "step": 1,
            "action": "Navigate to the schedule change request submission page",
            "expectedResult": "Schedule change request form is displayed"
          },
          {
            "step": 2,
            "action": "Submit a new schedule change request with all required details (schedule ID, change description, reason)",
            "expectedResult": "Schedule change request is submitted successfully and confirmation message is displayed"
          },
          {
            "step": 3,
            "action": "Navigate to the approval workflow and approve the submitted schedule change request",
            "expectedResult": "Schedule change request is approved successfully and status is updated"
          },
          {
            "step": 4,
            "action": "Navigate to the audit logs portal via secure access point",
            "expectedResult": "Audit logs dashboard is displayed with search and filter options"
          },
          {
            "step": 5,
            "action": "Query audit logs without any filters to view all recent activities",
            "expectedResult": "All workflow activities are displayed including the submission and approval actions performed in previous steps with user identity, timestamps, and action details"
          },
          {
            "step": 6,
            "action": "Verify that the schedule change request submission log entry contains: user ID, timestamp, action type (submission), request ID, and change details",
            "expectedResult": "Log entry displays all required fields with correct and complete information"
          },
          {
            "step": 7,
            "action": "Verify that the schedule change approval log entry contains: approver user ID, timestamp, action type (approval), request ID, and approval details",
            "expectedResult": "Log entry displays all required fields with correct and complete information"
          },
          {
            "step": 8,
            "action": "Apply filters to audit logs: filter by user (select the user who submitted the request), action type (submission), and date range (today's date)",
            "expectedResult": "Filtered results are returned within 5 seconds showing only the submission activity by the selected user"
          },
          {
            "step": 9,
            "action": "Clear filters and apply new filters: filter by action type (approval) and date range (today's date)",
            "expectedResult": "Filtered results are returned within 5 seconds showing only approval activities for today"
          },
          {
            "step": 10,
            "action": "Measure and record the query response time for the filtered results",
            "expectedResult": "Query response time is 5 seconds or less"
          },
          {
            "step": 11,
            "action": "Select the export option and choose CSV format for audit logs",
            "expectedResult": "Export dialog is displayed with CSV format selected"
          },
          {
            "step": 12,
            "action": "Confirm the export and download the audit log file",
            "expectedResult": "CSV file is downloaded successfully to the local system"
          },
          {
            "step": 13,
            "action": "Open the exported CSV file and verify its contents",
            "expectedResult": "CSV file contains all filtered audit log entries with correct columns: user ID, timestamp, action type, request ID, and details. Data matches the displayed logs in the portal"
          },
          {
            "step": 14,
            "action": "Select the export option again and choose JSON format for audit logs",
            "expectedResult": "Export dialog is displayed with JSON format selected"
          },
          {
            "step": 15,
            "action": "Confirm the export and download the audit log file in JSON format",
            "expectedResult": "JSON file is downloaded successfully and contains properly formatted audit log data matching the portal display"
          }
        ],
        "postconditions": [
          "All schedule change workflow activities are logged in AuditLogs table",
          "Audit logs contain complete and accurate information for all performed actions",
          "Exported audit log files are saved locally and contain correct data",
          "System remains in stable state with audit logging continuing to function",
          "No data integrity issues in audit logs"
        ],
        "estimatedTime": "15 mins"
      },
      {
        "id": "tc-002",
        "title": "Ensure audit log access is restricted",
        "type": "error-case",
        "priority": "High",
        "preconditions": [
          "Audit logging system is operational",
          "Role-based access control (RBAC) is configured and enabled",
          "Test user account exists without audit log access permissions",
          "Audit logs contain data from previous workflow activities",
          "Security policies are enforced at application level"
        ],
        "steps": [
          {
            "step": 1,
            "action": "Log out from any existing administrator session",
            "expectedResult": "User is successfully logged out and redirected to login page"
          },
          {
            "step": 2,
            "action": "Log in with an unauthorized user account (user without administrator or audit access role)",
            "expectedResult": "User is successfully authenticated and logged into the system with limited permissions"
          },
          {
            "step": 3,
            "action": "Attempt to navigate to the audit logs portal URL directly by entering the URL in the browser",
            "expectedResult": "Access is denied and error message is displayed: 'Access Denied - You do not have permission to view audit logs' or similar message with HTTP 403 Forbidden status"
          },
          {
            "step": 4,
            "action": "Check if audit logs menu option is visible in the navigation menu for the unauthorized user",
            "expectedResult": "Audit logs menu option is not visible or is disabled in the navigation menu"
          },
          {
            "step": 5,
            "action": "Attempt to access audit logs via API endpoint GET /api/audit-logs using the unauthorized user's authentication token",
            "expectedResult": "API request is rejected with HTTP 403 Forbidden status and error response: 'Insufficient permissions to access audit logs'"
          },
          {
            "step": 6,
            "action": "Verify that no audit log data is returned in the API response",
            "expectedResult": "Response body contains error message only, no audit log data is exposed"
          },
          {
            "step": 7,
            "action": "Log out from the unauthorized user account",
            "expectedResult": "User is successfully logged out"
          },
          {
            "step": 8,
            "action": "Log in with a System Administrator account that has audit log access permissions",
            "expectedResult": "Administrator is successfully authenticated and logged in"
          },
          {
            "step": 9,
            "action": "Navigate to the audit logs portal",
            "expectedResult": "Audit logs dashboard is displayed successfully with full access to all audit log features"
          },
          {
            "step": 10,
            "action": "Verify that the previous unauthorized access attempts are logged in the audit logs",
            "expectedResult": "Audit logs contain entries showing the unauthorized access attempts with user ID, timestamp, action type (access denied), and resource (audit logs)"
          }
        ],
        "postconditions": [
          "Unauthorized users remain unable to access audit logs",
          "Security policies continue to be enforced",
          "All access attempts (authorized and unauthorized) are logged",
          "System security integrity is maintained",
          "Administrator can verify all access attempts through audit logs"
        ],
        "estimatedTime": "10 mins"
      }
    ]
  }
]