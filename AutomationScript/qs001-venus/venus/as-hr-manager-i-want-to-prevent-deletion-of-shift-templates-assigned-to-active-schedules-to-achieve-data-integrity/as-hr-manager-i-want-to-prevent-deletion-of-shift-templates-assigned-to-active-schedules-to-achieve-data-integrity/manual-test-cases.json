[
  {
    "storyId": "db-story-story-6",
    "storyTitle": "As HR Manager, I want to prevent deletion of shift templates assigned to active schedules to achieve data integrity",
    "testCases": [
      {
        "id": "tc-001",
        "title": "Verify system blocks deletion of shift template assigned to active schedules",
        "type": "happy-path",
        "priority": "High",
        "preconditions": [
          "User is logged in as HR Manager with delete permissions",
          "At least one shift template exists in the system",
          "The shift template is assigned to one or more active schedules",
          "User is on the Shift Templates management page"
        ],
        "steps": [
          {
            "step": 1,
            "action": "Navigate to the Shift Templates management page",
            "expectedResult": "Shift Templates page loads successfully displaying list of all shift templates"
          },
          {
            "step": 2,
            "action": "Identify a shift template that is assigned to active schedules",
            "expectedResult": "Shift template is visible in the list with assignment indicator"
          },
          {
            "step": 3,
            "action": "Click on the delete button/icon for the selected shift template",
            "expectedResult": "System initiates deletion process and checks for active schedule assignments"
          },
          {
            "step": 4,
            "action": "Observe the system response",
            "expectedResult": "System displays a warning message stating 'This shift template cannot be deleted as it is assigned to active schedules' or similar clear message"
          },
          {
            "step": 5,
            "action": "Verify the deletion is blocked",
            "expectedResult": "Delete operation is prevented and the shift template remains in the system"
          },
          {
            "step": 6,
            "action": "Click OK or Close on the warning message",
            "expectedResult": "Warning dialog closes and user returns to Shift Templates page with template still present"
          }
        ],
        "postconditions": [
          "Shift template remains in the system unchanged",
          "Active schedules continue to reference the shift template",
          "Deletion attempt is logged in the audit trail",
          "No data integrity issues occur"
        ],
        "estimatedTime": "5 mins"
      },
      {
        "id": "tc-002",
        "title": "Verify system allows deletion of shift template not assigned to any schedules",
        "type": "happy-path",
        "priority": "High",
        "preconditions": [
          "User is logged in as HR Manager with delete permissions",
          "At least one shift template exists that is NOT assigned to any schedules",
          "User is on the Shift Templates management page"
        ],
        "steps": [
          {
            "step": 1,
            "action": "Navigate to the Shift Templates management page",
            "expectedResult": "Shift Templates page loads successfully displaying list of all shift templates"
          },
          {
            "step": 2,
            "action": "Identify a shift template that is not assigned to any schedules",
            "expectedResult": "Shift template is visible in the list without any assignment indicator"
          },
          {
            "step": 3,
            "action": "Click on the delete button/icon for the unassigned shift template",
            "expectedResult": "System initiates deletion process and checks for active schedule assignments"
          },
          {
            "step": 4,
            "action": "Observe the system response",
            "expectedResult": "System displays a confirmation dialog asking 'Are you sure you want to delete this shift template?'"
          },
          {
            "step": 5,
            "action": "Click 'Confirm' or 'Yes' on the confirmation dialog",
            "expectedResult": "System processes the deletion request via DELETE /api/shifttemplates/{id} endpoint"
          },
          {
            "step": 6,
            "action": "Observe the deletion result",
            "expectedResult": "System displays success message 'Shift template deleted successfully' and removes the template from the list"
          },
          {
            "step": 7,
            "action": "Verify the template is no longer in the list",
            "expectedResult": "Deleted shift template is not visible in the Shift Templates list"
          }
        ],
        "postconditions": [
          "Shift template is permanently removed from the system",
          "Shift Templates list is updated and does not show the deleted template",
          "Deletion is logged in the audit trail with success status",
          "No schedules are affected as template was unassigned"
        ],
        "estimatedTime": "5 mins"
      },
      {
        "id": "tc-003",
        "title": "Verify system logs deletion attempts for templates assigned to active schedules",
        "type": "happy-path",
        "priority": "Medium",
        "preconditions": [
          "User is logged in as HR Manager with delete permissions",
          "At least one shift template exists that is assigned to active schedules",
          "User has access to audit logs or system logs",
          "User is on the Shift Templates management page"
        ],
        "steps": [
          {
            "step": 1,
            "action": "Navigate to the Shift Templates management page",
            "expectedResult": "Shift Templates page loads successfully"
          },
          {
            "step": 2,
            "action": "Note the current timestamp and the shift template ID to be deleted",
            "expectedResult": "Template ID and timestamp are recorded for audit verification"
          },
          {
            "step": 3,
            "action": "Attempt to delete a shift template that is assigned to active schedules",
            "expectedResult": "System blocks deletion and displays warning message"
          },
          {
            "step": 4,
            "action": "Close the warning message",
            "expectedResult": "User returns to Shift Templates page"
          },
          {
            "step": 5,
            "action": "Navigate to the audit logs or system logs section",
            "expectedResult": "Audit logs page loads successfully"
          },
          {
            "step": 6,
            "action": "Search for the deletion attempt using the template ID and timestamp",
            "expectedResult": "Log entry is found for the deletion attempt"
          },
          {
            "step": 7,
            "action": "Verify the log entry contains: timestamp, user ID, template ID, action attempted (DELETE), outcome (BLOCKED), and reason",
            "expectedResult": "Log entry shows all required information including 'BLOCKED - Template assigned to active schedules'"
          }
        ],
        "postconditions": [
          "Deletion attempt is recorded in audit logs",
          "Log entry contains complete information for audit purposes",
          "Audit trail maintains data integrity"
        ],
        "estimatedTime": "7 mins"
      },
      {
        "id": "tc-004",
        "title": "Verify system logs successful deletion of unassigned templates",
        "type": "happy-path",
        "priority": "Medium",
        "preconditions": [
          "User is logged in as HR Manager with delete permissions",
          "At least one shift template exists that is NOT assigned to any schedules",
          "User has access to audit logs or system logs",
          "User is on the Shift Templates management page"
        ],
        "steps": [
          {
            "step": 1,
            "action": "Navigate to the Shift Templates management page",
            "expectedResult": "Shift Templates page loads successfully"
          },
          {
            "step": 2,
            "action": "Note the current timestamp and the shift template ID to be deleted",
            "expectedResult": "Template ID and timestamp are recorded for audit verification"
          },
          {
            "step": 3,
            "action": "Delete a shift template that is not assigned to any schedules",
            "expectedResult": "System allows deletion and displays success message"
          },
          {
            "step": 4,
            "action": "Navigate to the audit logs or system logs section",
            "expectedResult": "Audit logs page loads successfully"
          },
          {
            "step": 5,
            "action": "Search for the deletion event using the template ID and timestamp",
            "expectedResult": "Log entry is found for the deletion event"
          },
          {
            "step": 6,
            "action": "Verify the log entry contains: timestamp, user ID, template ID, action performed (DELETE), and outcome (SUCCESS)",
            "expectedResult": "Log entry shows all required information including 'SUCCESS - Template deleted'"
          }
        ],
        "postconditions": [
          "Successful deletion is recorded in audit logs",
          "Log entry contains complete information for compliance",
          "Audit trail is complete and accurate"
        ],
        "estimatedTime": "7 mins"
      },
      {
        "id": "tc-005",
        "title": "Verify warning message clarity when attempting to delete assigned template",
        "type": "happy-path",
        "priority": "High",
        "preconditions": [
          "User is logged in as HR Manager with delete permissions",
          "At least one shift template exists that is assigned to active schedules",
          "User is on the Shift Templates management page"
        ],
        "steps": [
          {
            "step": 1,
            "action": "Navigate to the Shift Templates management page",
            "expectedResult": "Shift Templates page loads successfully"
          },
          {
            "step": 2,
            "action": "Attempt to delete a shift template assigned to active schedules",
            "expectedResult": "System displays a warning dialog"
          },
          {
            "step": 3,
            "action": "Read and verify the warning message content",
            "expectedResult": "Warning message clearly states: 1) Template cannot be deleted, 2) Reason is assignment to active schedules, 3) Suggests alternative actions if applicable"
          },
          {
            "step": 4,
            "action": "Verify the warning dialog has appropriate buttons (OK, Close, or Cancel)",
            "expectedResult": "Dialog has clear dismissal option without proceeding with deletion"
          },
          {
            "step": 5,
            "action": "Check if the warning message includes the number of active schedules using the template",
            "expectedResult": "Message optionally displays count of affected schedules for user awareness"
          }
        ],
        "postconditions": [
          "User understands why deletion was blocked",
          "User awareness of deletion restrictions is achieved",
          "Template remains in the system"
        ],
        "estimatedTime": "4 mins"
      },
      {
        "id": "tc-006",
        "title": "Verify real-time usage check performance when deleting template",
        "type": "happy-path",
        "priority": "Medium",
        "preconditions": [
          "User is logged in as HR Manager with delete permissions",
          "Multiple shift templates exist in the system",
          "Some templates are assigned to active schedules, some are not",
          "User is on the Shift Templates management page"
        ],
        "steps": [
          {
            "step": 1,
            "action": "Navigate to the Shift Templates management page",
            "expectedResult": "Shift Templates page loads successfully"
          },
          {
            "step": 2,
            "action": "Note the current time and click delete on a shift template assigned to active schedules",
            "expectedResult": "System initiates real-time usage check"
          },
          {
            "step": 3,
            "action": "Measure the time taken for the system to display the warning message",
            "expectedResult": "Warning message appears within 2-3 seconds indicating real-time performance"
          },
          {
            "step": 4,
            "action": "Close the warning dialog",
            "expectedResult": "Dialog closes and user returns to template list"
          },
          {
            "step": 5,
            "action": "Note the current time and click delete on an unassigned shift template",
            "expectedResult": "System initiates real-time usage check"
          },
          {
            "step": 6,
            "action": "Measure the time taken for the system to display the confirmation dialog",
            "expectedResult": "Confirmation dialog appears within 2-3 seconds indicating real-time performance"
          }
        ],
        "postconditions": [
          "System performs usage checks in real-time without delays",
          "User experience is not impacted by performance issues",
          "Both assigned and unassigned templates are checked efficiently"
        ],
        "estimatedTime": "6 mins"
      },
      {
        "id": "tc-007",
        "title": "Verify role-based access control for template deletion",
        "type": "error-case",
        "priority": "High",
        "preconditions": [
          "User is logged in with a role other than HR Manager (e.g., Employee, Supervisor)",
          "Shift templates exist in the system",
          "User navigates to Shift Templates page or attempts to access deletion functionality"
        ],
        "steps": [
          {
            "step": 1,
            "action": "Login with a user account that does not have HR Manager role",
            "expectedResult": "User successfully logs into the system"
          },
          {
            "step": 2,
            "action": "Attempt to navigate to the Shift Templates management page",
            "expectedResult": "Either page is not accessible or delete functionality is not visible/enabled"
          },
          {
            "step": 3,
            "action": "If page is accessible, verify that delete buttons/icons are not present or are disabled",
            "expectedResult": "Delete functionality is not available to unauthorized users"
          },
          {
            "step": 4,
            "action": "If attempting direct API call, send DELETE request to /api/shifttemplates/{id}",
            "expectedResult": "System returns 403 Forbidden or 401 Unauthorized error"
          },
          {
            "step": 5,
            "action": "Verify error message indicates insufficient permissions",
            "expectedResult": "Clear error message states 'You do not have permission to delete shift templates' or similar"
          }
        ],
        "postconditions": [
          "Unauthorized user cannot delete shift templates",
          "Security is maintained through role-based access control",
          "Unauthorized attempt is logged in audit trail"
        ],
        "estimatedTime": "5 mins"
      },
      {
        "id": "tc-008",
        "title": "Verify system behavior when template becomes assigned between check and deletion",
        "type": "edge-case",
        "priority": "Medium",
        "preconditions": [
          "User is logged in as HR Manager with delete permissions",
          "At least one shift template exists that is currently unassigned",
          "Another HR Manager or system process can assign templates to schedules",
          "User is on the Shift Templates management page"
        ],
        "steps": [
          {
            "step": 1,
            "action": "Navigate to the Shift Templates management page",
            "expectedResult": "Shift Templates page loads successfully"
          },
          {
            "step": 2,
            "action": "Identify an unassigned shift template and initiate deletion",
            "expectedResult": "System displays confirmation dialog for deletion"
          },
          {
            "step": 3,
            "action": "Before confirming deletion, have another user assign this template to an active schedule",
            "expectedResult": "Template is now assigned to an active schedule in the database"
          },
          {
            "step": 4,
            "action": "Click 'Confirm' on the deletion dialog",
            "expectedResult": "System performs final usage check before executing deletion"
          },
          {
            "step": 5,
            "action": "Observe the system response",
            "expectedResult": "System detects the template is now assigned and blocks deletion with appropriate warning message"
          },
          {
            "step": 6,
            "action": "Verify the template remains in the system",
            "expectedResult": "Template is not deleted and remains assigned to the active schedule"
          }
        ],
        "postconditions": [
          "Template remains in the system despite initial unassigned status",
          "Data integrity is maintained through final usage check",
          "No schedule inconsistencies occur"
        ],
        "estimatedTime": "8 mins"
      },
      {
        "id": "tc-009",
        "title": "Verify system behavior when attempting to delete multiple templates simultaneously",
        "type": "edge-case",
        "priority": "Low",
        "preconditions": [
          "User is logged in as HR Manager with delete permissions",
          "Multiple shift templates exist in the system",
          "Some templates are assigned to active schedules, some are not",
          "System supports bulk deletion or multiple selection",
          "User is on the Shift Templates management page"
        ],
        "steps": [
          {
            "step": 1,
            "action": "Navigate to the Shift Templates management page",
            "expectedResult": "Shift Templates page loads successfully"
          },
          {
            "step": 2,
            "action": "Select multiple shift templates including both assigned and unassigned templates",
            "expectedResult": "Multiple templates are selected as indicated by checkboxes or highlighting"
          },
          {
            "step": 3,
            "action": "Click the bulk delete button or delete action",
            "expectedResult": "System initiates usage check for all selected templates"
          },
          {
            "step": 4,
            "action": "Observe the system response",
            "expectedResult": "System displays a message indicating which templates can be deleted and which cannot, with reasons"
          },
          {
            "step": 5,
            "action": "Verify the message lists assigned templates that will be skipped",
            "expectedResult": "Clear list shows templates blocked from deletion due to active schedule assignments"
          },
          {
            "step": 6,
            "action": "Confirm the bulk deletion",
            "expectedResult": "System deletes only the unassigned templates and preserves assigned ones"
          },
          {
            "step": 7,
            "action": "Verify the results in the template list",
            "expectedResult": "Unassigned templates are removed, assigned templates remain in the list"
          }
        ],
        "postconditions": [
          "Only unassigned templates are deleted",
          "Assigned templates remain in the system",
          "All deletion attempts are logged in audit trail",
          "Data integrity is maintained"
        ],
        "estimatedTime": "8 mins"
      },
      {
        "id": "tc-010",
        "title": "Verify system behavior when template is assigned to inactive schedules",
        "type": "boundary",
        "priority": "Medium",
        "preconditions": [
          "User is logged in as HR Manager with delete permissions",
          "At least one shift template exists that is assigned only to inactive/past schedules",
          "No active schedules are using this template",
          "User is on the Shift Templates management page"
        ],
        "steps": [
          {
            "step": 1,
            "action": "Navigate to the Shift Templates management page",
            "expectedResult": "Shift Templates page loads successfully"
          },
          {
            "step": 2,
            "action": "Identify a shift template that is assigned only to inactive or past schedules",
            "expectedResult": "Template is visible in the list"
          },
          {
            "step": 3,
            "action": "Click on the delete button for this template",
            "expectedResult": "System checks for active schedule assignments only"
          },
          {
            "step": 4,
            "action": "Observe the system response",
            "expectedResult": "System allows deletion since template is not assigned to any ACTIVE schedules and displays confirmation dialog"
          },
          {
            "step": 5,
            "action": "Confirm the deletion",
            "expectedResult": "System successfully deletes the template and displays success message"
          },
          {
            "step": 6,
            "action": "Verify the template is removed from the list",
            "expectedResult": "Template no longer appears in the Shift Templates list"
          }
        ],
        "postconditions": [
          "Template assigned only to inactive schedules is successfully deleted",
          "Inactive schedules maintain historical reference if needed",
          "Deletion is logged in audit trail",
          "System correctly distinguishes between active and inactive schedule assignments"
        ],
        "estimatedTime": "6 mins"
      },
      {
        "id": "tc-011",
        "title": "Verify API endpoint returns correct error code when deleting assigned template",
        "type": "error-case",
        "priority": "High",
        "preconditions": [
          "User has valid authentication token with HR Manager role",
          "At least one shift template exists that is assigned to active schedules",
          "API endpoint DELETE /api/shifttemplates/{id} is accessible",
          "User has API testing tool (Postman, curl, etc.)"
        ],
        "steps": [
          {
            "step": 1,
            "action": "Identify the ID of a shift template assigned to active schedules",
            "expectedResult": "Template ID is obtained from the system"
          },
          {
            "step": 2,
            "action": "Send DELETE request to /api/shifttemplates/{id} with valid authentication token",
            "expectedResult": "API receives the request and processes it"
          },
          {
            "step": 3,
            "action": "Verify the HTTP response status code",
            "expectedResult": "API returns 409 Conflict or 400 Bad Request status code"
          },
          {
            "step": 4,
            "action": "Verify the response body contains error details",
            "expectedResult": "Response includes error message explaining template is assigned to active schedules"
          },
          {
            "step": 5,
            "action": "Verify the response includes appropriate error code or identifier",
            "expectedResult": "Response contains structured error information (e.g., errorCode: 'TEMPLATE_IN_USE')"
          },
          {
            "step": 6,
            "action": "Verify the template still exists in the database",
            "expectedResult": "Template is not deleted and remains in the system"
          }
        ],
        "postconditions": [
          "Template remains in the system",
          "API returns appropriate error response",
          "Deletion attempt is logged",
          "Data integrity is maintained"
        ],
        "estimatedTime": "6 mins"
      },
      {
        "id": "tc-012",
        "title": "Verify API endpoint returns success when deleting unassigned template",
        "type": "happy-path",
        "priority": "High",
        "preconditions": [
          "User has valid authentication token with HR Manager role",
          "At least one shift template exists that is NOT assigned to any schedules",
          "API endpoint DELETE /api/shifttemplates/{id} is accessible",
          "User has API testing tool (Postman, curl, etc.)"
        ],
        "steps": [
          {
            "step": 1,
            "action": "Identify the ID of a shift template not assigned to any schedules",
            "expectedResult": "Template ID is obtained from the system"
          },
          {
            "step": 2,
            "action": "Send DELETE request to /api/shifttemplates/{id} with valid authentication token",
            "expectedResult": "API receives the request and processes it"
          },
          {
            "step": 3,
            "action": "Verify the HTTP response status code",
            "expectedResult": "API returns 200 OK or 204 No Content status code"
          },
          {
            "step": 4,
            "action": "Verify the response body contains success confirmation",
            "expectedResult": "Response includes success message or empty body for 204 status"
          },
          {
            "step": 5,
            "action": "Send GET request to retrieve the deleted template",
            "expectedResult": "API returns 404 Not Found confirming template no longer exists"
          },
          {
            "step": 6,
            "action": "Verify the template is removed from the database",
            "expectedResult": "Template cannot be found in the system"
          }
        ],
        "postconditions": [
          "Template is permanently deleted from the system",
          "API returns successful response",
          "Deletion is logged in audit trail",
          "Template is no longer accessible via API"
        ],
        "estimatedTime": "6 mins"
      }
    ]
  }
]