```json
{
  "success": true,
  "playwrightTests": [
    {
      "storyId": "story-9",
      "storyTitle": "As HR Manager, I want to generate reports on shift template usage to analyze scheduling patterns",
      "testFile": "shift-template-usage-reports.spec.ts",
      "testCode": "import { test, expect } from '@playwright/test';\n\ntest.describe('Shift Template Usage Reports - Story 9', () => {\n  test.beforeEach(async ({ page }) => {\n    // Login as HR Manager\n    await page.goto('/login');\n    await page.fill('[data-testid=\"email-input\"]', 'hrmanager@company.com');\n    await page.fill('[data-testid=\"password-input\"]', 'SecurePass123!');\n    await page.click('[data-testid=\"login-button\"]');\n    await expect(page).toHaveURL(/.*dashboard/);\n  });\n\n  test('HR Manager can navigate to reporting page and generate shift template usage report', async ({ page }) => {\n    // Navigate to reporting page\n    await page.click('[data-testid=\"reports-menu\"]');\n    await page.click('[data-testid=\"shift-template-usage-reports\"]');\n    await expect(page).toHaveURL(/.*reports\\/shifttemplateusage/);\n    await expect(page.locator('[data-testid=\"report-page-title\"]')).toContainText('Shift Template Usage Reports');\n\n    // Select report parameters\n    await page.selectOption('[data-testid=\"department-filter\"]', 'Engineering');\n    await page.fill('[data-testid=\"date-from-input\"]', '2024-01-01');\n    await page.fill('[data-testid=\"date-to-input\"]', '2024-01-31');\n    await page.click('[data-testid=\"template-filter\"]');\n    await page.click('[data-testid=\"template-option-morning-shift\"]');\n\n    // Generate report\n    await page.click('[data-testid=\"generate-report-button\"]');\n    await expect(page.locator('[data-testid=\"report-loading\"]')).toBeVisible();\n    await expect(page.locator('[data-testid=\"report-loading\"]')).toBeHidden({ timeout: 10000 });\n\n    // Verify report is displayed\n    await expect(page.locator('[data-testid=\"report-results\"]')).toBeVisible();\n    await expect(page.locator('[data-testid=\"report-table\"]')).toBeVisible();\n  });\n\n  test('System displays accurate shift template usage statistics by department', async ({ page }) => {\n    // Navigate to reporting page\n    await page.goto('/reports/shifttemplateusage');\n\n    // Select specific department\n    await page.selectOption('[data-testid=\"department-filter\"]', 'Sales');\n    await page.fill('[data-testid=\"date-from-input\"]', '2024-01-01');\n    await page.fill('[data-testid=\"date-to-input\"]', '2024-01-31');\n    await page.click('[data-testid=\"generate-report-button\"]');\n    await page.waitForSelector('[data-testid=\"report-results\"]', { state: 'visible' });\n\n    // Verify department column shows correct department\n    const departmentCells = page.locator('[data-testid=\"report-table\"] tbody tr td:nth-child(1)');\n    const count = await departmentCells.count();\n    for (let i = 0; i < count; i++) {\n      await expect(departmentCells.nth(i)).toContainText('Sales');\n    }\n\n    // Verify report contains template names\n    await expect(page.locator('[data-testid=\"template-name-column\"]')).toBeVisible();\n    await expect(page.locator('[data-testid=\"report-table\"] tbody tr').first()).toBeVisible();\n  });\n\n  test('System displays total assigned hours and frequency per template', async ({ page }) => {\n    // Navigate and generate report\n    await page.goto('/reports/shifttemplateusage');\n    await page.selectOption('[data-testid=\"department-filter\"]', 'Engineering');\n    await page.fill('[data-testid=\"date-from-input\"]', '2024-01-01');\n    await page.fill('[data-testid=\"date-to-input\"]', '2024-01-31');\n    await page.click('[data-testid=\"generate-report-button\"]');\n    await page.waitForSelector('[data-testid=\"report-results\"]', { state: 'visible' });\n\n    // Verify total hours column exists and contains numeric values\n    await expect(page.locator('[data-testid=\"total-hours-header\"]')).toContainText('Total Assigned Hours');\n    const totalHoursCell = page.locator('[data-testid=\"report-table\"] tbody tr:first-child [data-testid=\"total-hours-cell\"]');\n    await expect(totalHoursCell).toBeVisible();\n    const hoursText = await totalHoursCell.textContent();\n    expect(parseFloat(hoursText || '0')).toBeGreaterThan(0);\n\n    // Verify frequency column exists and contains numeric values\n    await expect(page.locator('[data-testid=\"frequency-header\"]')).toContainText('Frequency');\n    const frequencyCell = page.locator('[data-testid=\"report-table\"] tbody tr:first-child [data-testid=\"frequency-cell\"]');\n    await expect(frequencyCell).toBeVisible();\n    const frequencyText = await frequencyCell.textContent();\n    expect(parseInt(frequencyText || '0')).toBeGreaterThan(0);\n  });\n\n  test('System allows export of reports in PDF format', async ({ page }) => {\n    // Navigate and generate report\n    await page.goto('/reports/shifttemplateusage');\n    await page.selectOption('[data-testid=\"department-filter\"]', 'Engineering');\n    await page.fill('[data-testid=\"date-from-input\"]', '2024-01-01');\n    await page.fill('[data-testid=\"date-to-input\"]', '2024-01-31');\n    await page.click('[data-testid=\"generate-report-button\"]');\n    await page.waitForSelector('[data-testid=\"report-results\"]', { state: 'visible' });\n\n    // Verify PDF export button is available\n    await expect(page.locator('[data-testid=\"export-pdf-button\"]')).toBeVisible();\n    await expect(page.locator('[data-testid=\"export-pdf-button\"]')).toBeEnabled();\n\n    // Click export PDF and verify download starts\n    const downloadPromise = page.waitForEvent('download');\n    await page.click('[data-testid=\"export-pdf-button\"]');\n    const download = await downloadPromise;\n    expect(download.suggestedFilename()).toContain('.pdf');\n    expect(download.suggestedFilename()).toContain('shift-template-usage');\n  });\n\n  test('System allows export of reports in Excel format', async ({ page }) => {\n    // Navigate and generate report\n    await page.goto('/reports/shifttemplateusage');\n    await page.selectOption('[data-testid=\"department-filter\"]', 'Sales');\n    await page.fill('[data-testid=\"date-from-input\"]', '2024-01-01');\n    await page.fill('[data-testid=\"date-to-input\"]', '2024-01-31');\n    await page.click('[data-testid=\"generate-report-button\"]');\n    await page.waitForSelector('[data-testid=\"