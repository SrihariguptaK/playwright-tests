json
{
  "success": true,
  "playwrightTests": [
    {
      "storyId": "story-9",
      "storyTitle": "As HR Manager, I want to manage user roles and permissions to achieve secure access control",
      "testFile": "user-roles-permissions.spec.ts",
      "testCode": "import { test, expect } from '@playwright/test';\n\ntest.describe('User Roles and Permissions Management', () => {\n  test.beforeEach(async ({ page }) => {\n    // Navigate to application and login as HR Manager\n    await page.goto('/login');\n    await page.fill('[data-testid=\"username-input\"]', 'hr.manager@company.com');\n    await page.fill('[data-testid=\"password-input\"]', 'HRManager123!');\n    await page.click('[data-testid=\"login-button\"]');\n    await expect(page).toHaveURL(/.*dashboard/);\n  });\n\n  test('Create and assign user roles successfully', async ({ page }) => {\n    // Step 1: HR Manager navigates to role management page\n    await page.click('[data-testid=\"admin-menu\"]');\n    await page.click('[data-testid=\"role-management-link\"]');\n    \n    // Expected Result: Role management UI is displayed\n    await expect(page.locator('[data-testid=\"role-management-page\"]')).toBeVisible();\n    await expect(page.locator('h1')).toContainText('Role Management');\n    await expect(page.locator('[data-testid=\"create-role-button\"]')).toBeVisible();\n    \n    // Step 2: Create new role with permissions\n    await page.click('[data-testid=\"create-role-button\"]');\n    await expect(page.locator('[data-testid=\"role-form-modal\"]')).toBeVisible();\n    \n    // Enter role name\n    await page.fill('[data-testid=\"role-name-input\"]', 'Scheduler');\n    \n    // Select specific permissions\n    await page.check('[data-testid=\"permission-view-schedules\"]');\n    await page.check('[data-testid=\"permission-edit-schedules\"]');\n    \n    // Save the role\n    await page.click('[data-testid=\"save-role-button\"]');\n    \n    // Expected Result: Role is saved successfully\n    await expect(page.locator('[data-testid=\"success-message\"]')).toBeVisible();\n    await expect(page.locator('[data-testid=\"success-message\"]')).toContainText('Role created successfully');\n    await expect(page.locator('[data-testid=\"role-list\"]')).toContainText('Scheduler');\n    \n    // Assign the newly created role to a user\n    await page.click('[data-testid=\"user-assignment-tab\"]');\n    await expect(page.locator('[data-testid=\"user-list\"]')).toBeVisible();\n    \n    // Select user from the list\n    await page.click('[data-testid=\"select-user-dropdown\"]');\n    await page.click('[data-testid=\"user-option-john-doe\"]');\n    \n    // Choose the role from dropdown\n    await page.click('[data-testid=\"select-role-dropdown\"]');\n    await page.click('text=Scheduler');\n    \n    // Click Assign button\n    await page.click('[data-testid=\"assign-role-button\"]');\n    \n    // Expected Result: User assigned successfully\n    await expect(page.locator('[data-testid=\"success-message\"]')).toBeVisible();\n    await expect(page.locator('[data-testid=\"success-message\"]')).toContainText('Role assigned successfully');\n    \n    // Verify the assignment appears in the user list\n    await expect(page.locator('[data-testid=\"user-role-assignment\"]')).toContainText('John Doe');\n    await expect(page.locator('[data-testid=\"user-role-assignment\"]')).toContainText('Scheduler');\n    \n    // Verify audit log entry is created\n    await page.click('[data-testid=\"audit-log-tab\"]');\n    await expect(page.locator('[data-testid=\"audit-log-list\"]')).toContainText('Role created: Scheduler');\n    await expect(page.locator('[data-testid=\"audit-log-list\"]')).toContainText('Role assigned to John Doe');\n  });\n\n  test('Restrict access to role management', async ({ page }) => {\n    // Logout as HR Manager\n    await page.click('[data-testid=\"user-profile-menu\"]');\n    await page.click('[data-testid=\"logout-button\"]');\n    await expect(page).toHaveURL(/.*login/);\n    \n    // Login as Non-HR user (regular employee)\n    await page.fill('[data-testid=\"username-input\"]', 'employee@company.com');\n    await page.fill('[data-testid=\"password-input\"]', 'Employee123!');\n    await page.click('[data-testid=\"login-button\"]');\n    await expect(page).toHaveURL(/.*dashboard/);\n    \n    // Step 1: Non-HR user attempts to access role management via menu\n    // Expected Result: Menu option should not be visible or accessible\n    const adminMenu = page.locator('[data-testid=\"admin-menu\"]');\n    await expect(adminMenu).not.toBeVisible();\n    \n    // Attempt to access role management page directly via URL\n    await page.goto('/admin/role-management');\n    \n    // Expected Result: Access is denied with appropriate message\n    await expect(page.locator('[data-testid=\"access-denied-message\"]')).toBeVisible();\n    await expect(page.locator('[data-testid=\"access-denied-message\"]')).toContainText('Access Denied');\n    await expect(page.locator('[data-testid=\"error-description\"]')).toContainText('You do not have permission to access this page');\n    \n    // Verify user is redirected or stays on error page\n    await expect(page).toHaveURL(/.*access-denied|.*403|.*unauthorized/);\n    \n    // Verify role management UI is not displayed\n    await expect(page.locator('[data-testid=\"role-management-page\"]')).not.toBeVisible();\n    await expect(page.locator('[data-testid=\"create-role-button\"]')).not.toBeVisible();\n  });\n});"
    }
  ]
}