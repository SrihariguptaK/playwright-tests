json
{
  "success": true,
  "playwrightTests": [
    {
      "storyId": "story-14",
      "storyTitle": "As Scheduler, I want to configure conflict detection rules to tailor alerts to my resource types",
      "testFile": "conflict-detection-rules.spec.ts",
      "testCode": "import { test, expect } from '@playwright/test';\n\ntest.describe('Story-14: Configure Conflict Detection Rules', () => {\n  test.beforeEach(async ({ page }) => {\n    // Navigate to the application and login as scheduler\n    await page.goto('/login');\n    await page.fill('[data-testid=\"username-input\"]', 'scheduler@example.com');\n    await page.fill('[data-testid=\"password-input\"]', 'password123');\n    await page.click('[data-testid=\"login-button\"]');\n    await expect(page).toHaveURL(/.*dashboard/);\n  });\n\n  test('Validate rule configuration and application (happy-path)', async ({ page }) => {\n    // Step 1: Navigate to the conflict rule configuration interface via the system menu or direct URL\n    await page.click('[data-testid=\"settings-menu\"]');\n    await page.click('[data-testid=\"conflict-rules-link\"]');\n    await expect(page).toHaveURL(/.*conflict-rules/);\n    \n    // Expected Result: Current rules displayed\n    await expect(page.locator('[data-testid=\"rules-container\"]')).toBeVisible();\n    await expect(page.locator('[data-testid=\"resource-type-list\"]')).toBeVisible();\n    \n    // Step 2: Review the displayed current rules for all resource types\n    const resourceTypes = await page.locator('[data-testid=\"resource-type-item\"]').count();\n    expect(resourceTypes).toBeGreaterThan(0);\n    \n    // Step 3: Select a specific resource type (e.g., Conference Room)\n    await page.click('[data-testid=\"resource-type-conference-room\"]');\n    await expect(page.locator('[data-testid=\"rule-editor-panel\"]')).toBeVisible();\n    \n    // Step 4: Modify rules with valid settings\n    await page.fill('[data-testid=\"allowable-overlap-input\"]', '15');\n    await page.check('[data-testid=\"enable-buffer-time-checkbox\"]');\n    \n    // Step 5: Click the Save button to persist the rule changes\n    await page.click('[data-testid=\"save-rules-button\"]');\n    \n    // Expected Result: Rules saved and applied successfully\n    await expect(page.locator('[data-testid=\"success-message\"]')).toBeVisible();\n    await expect(page.locator('[data-testid=\"success-message\"]')).toContainText('Rules saved and applied successfully');\n    \n    // Step 6: Verify the saved rules by refreshing the configuration interface\n    await page.reload();\n    await page.click('[data-testid=\"resource-type-conference-room\"]');\n    await expect(page.locator('[data-testid=\"allowable-overlap-input\"]')).toHaveValue('15');\n    await expect(page.locator('[data-testid=\"enable-buffer-time-checkbox\"]')).toBeChecked();\n    \n    // Step 7: Attempt to create a new rule with invalid syntax (negative overlap time)\n    await page.fill('[data-testid=\"allowable-overlap-input\"]', '-10');\n    await page.click('[data-testid=\"save-rules-button\"]');\n    \n    // Expected Result: System rejects changes with descriptive error messages\n    await expect(page.locator('[data-testid=\"error-message\"]')).toBeVisible();\n    await expect(page.locator('[data-testid=\"error-message\"]')).toContainText('Overlap time cannot be negative');\n    \n    // Step 8: Attempt to save conflicting rules\n    await page.fill('[data-testid=\"allowable-overlap-input\"]', '30');\n    await page.fill('[data-testid=\"min-booking-duration-input\"]', '120');\n    await page.fill('[data-testid=\"max-booking-duration-input\"]', '60');\n    await page.click('[data-testid=\"save-rules-button\"]');\n    \n    // Expected Result: System rejects conflicting rules\n    await expect(page.locator('[data-testid=\"error-message\"]')).toBeVisible();\n    await expect(page.locator('[data-testid=\"error-message\"]')).toContainText('Minimum booking duration cannot exceed maximum booking duration');\n    \n    // Step 9: Correct the invalid rules to valid settings and attempt to save again\n    await page.fill('[data-testid=\"min-booking-duration-input\"]', '30');\n    await page.fill('[data-testid=\"max-booking-duration-input\"]', '120');\n    await page.click('[data-testid=\"save-rules-button\"]');\n    \n    // Expected Result: Rules saved successfully\n    await expect(page.locator('[data-testid=\"success-message\"]')).toBeVisible();\n    await expect(page.locator('[data-testid=\"success-message\"]')).toContainText('Rules saved and applied successfully');\n  });\n\n  test('Verify detection engine applies updated rules (happy-path)', async ({ page }) => {\n    // Step 1: Navigate to the conflict rule configuration interface\n    await page.goto('/conflict-rules');\n    await expect(page.locator('[data-testid=\"rules-container\"]')).toBeVisible();\n    \n    // Step 2: Document the current rules for Meeting Room resource type\n    await page.click('[data-testid=\"resource-type-meeting-room\"]');\n    const currentOverlap = await page.locator('[data-testid=\"allowable-overlap-input\"]').inputValue();\n    \n    // Step 3: Modify the conflict detection rules for Meeting Room\n    await page.fill('[data-testid=\"allowable-overlap-input\"]', '30');\n    await page.uncheck('[data-testid=\"strict-time-slot-checkbox\"]');\n    \n    // Step 4: Save the updated rules and note the timestamp\n    const saveTimestamp = Date.now();\n    await page.click('[data-testid=\"save-rules-button\"]');\n    await expect(page.locator('[data-testid=\"success-message\"]')).toBeVisible();\n    \n    // Step 5: Wait and monitor for up to 1 minute for rule propagation\n    await page.waitForTimeout(60000); // Wait 1 minute for rule propagation\n    \n    // Step 6: Verify via system logs or admin interface that rules have been applied\n    await page.click('[data-testid=\"system-status-link\"]');\n    await expect(page.locator('[data-testid=\"rule-status-indicator\"]')).toContainText('Active');\n    const lastUpdated = await page.locator('[data-testid=\"rules-last-updated\"]').textContent();\n    expect(lastUpdated).toBeTruthy();\n    \n    // Step 7: Navigate to the booking creation interface\n    await page.goto('/bookings/create');\n    await expect(page.locator('[data-testid=\"booking-form\"]')).toBeVisible();\n    \n    // Step 8: Create a booking for Meeting Room resource\n    await page.selectOption('[data-testid=\"resource-type-select\"]', 'meeting-room');\n    await page.selectOption('[data-testid=\"resource-select\"]', 'meeting-room-101');\n    await page.fill('[data-testid=\"booking-title-input\"]', 'Test Booking 1');\n    await page.fill('[data-testid=\"start-time-input\"]', '2024-02-15T10:00');\n    await page.fill('[data-testid=\"end-time-input\"]', '2024-02-15T11:00');\n    await page.click('[data-testid=\"create-booking-button\"]');\n    await expect(page.locator('[data-testid=\"booking-success-message\"]')).toBeVisible();\n    \n    // Step 9: Create a booking that overlaps by exactly 25 minutes (within threshold)\n    await page.goto('/bookings/create');\n    await page.selectOption('[data-testid=\"resource-type-select\"]', 'meeting-room');\n    await page.selectOption('[data-testid=\"resource-select\"]', 'meeting-room-101');\n    await page.fill('[data-testid=\"booking-title-input\"]', 'Test Booking 2 - 25min Overlap');\n    await page.fill('[data-testid=\"start-time-input\"]', '2024-02-15T10:35');\n    await page.fill('[data-testid=\"end-time-input\"]', '2024-02-15T11:35');\n    await page.click('[data-testid=\"create-booking-button\"]');\n    \n    // Expected Result: No conflict notification (within 30-minute threshold)\n    await expect(page.locator('[data-testid=\"conflict-warning\"]')).not.toBeVisible();\n    await expect(page.locator('[data-testid=\"booking-success-message\"]')).toBeVisible();\n    \n    // Step 10: Create another booking that overlaps by 35 minutes (exceeding threshold)\n    await page.goto('/bookings/create');\n    await page.selectOption('[data-testid=\"resource-type-select\"]', 'meeting-room');\n    await page.selectOption('[data-testid=\"resource-select\"]', 'meeting-room-101');\n    await page.fill('[data-testid=\"booking-title-input\"]', 'Test Booking 3 - 35min Overlap');\n    await page.fill('[data-testid=\"start-time-input\"]', '2024-02-15T10:25');\n    await page.fill('[data-testid=\"end-time-input\"]', '2024-02-15T11:25');\n    await page.click('[data-testid=\"create-booking-button\"]');\n    \n    // Expected Result: Conflict detection triggered (exceeds 30-minute threshold)\n    await expect(page.locator('[data-testid=\"conflict-warning\"]')).toBeVisible();\n    await expect(page.locator('[data-testid=\"conflict-warning\"]')).toContainText('Conflict detected');\n    await expect(page.locator('[data-testid=\"conflict-details\"]')).toContainText('Overlap exceeds allowable threshold');\n  });\n});"
    }
  ]
}