json
{
  "success": true,
  "playwrightTests": [
    {
      "storyId": "story-5",
      "storyTitle": "As Scheduling Manager, I want to assign employees to shifts to ensure proper shift coverage",
      "testFile": "assign-employees-to-shifts.spec.ts",
      "testCode": "import { test, expect } from '@playwright/test';\n\ntest.describe('Assign Employees to Shifts', () => {\n  test.beforeEach(async ({ page }) => {\n    // Navigate to the application and login as Scheduling Manager\n    await page.goto('/login');\n    await page.fill('[data-testid=\"username-input\"]', 'scheduling.manager@company.com');\n    await page.fill('[data-testid=\"password-input\"]', 'password123');\n    await page.click('[data-testid=\"login-button\"]');\n    await expect(page).toHaveURL(/.*dashboard/);\n  });\n\n  test('Assign employee to shift with valid availability and role', async ({ page }) => {\n    // Step 1: Navigate to the shift schedule view from the main menu and select a specific shift\n    await page.click('[data-testid=\"main-menu\"]');\n    await page.click('[data-testid=\"shift-schedule-link\"]');\n    await expect(page.locator('[data-testid=\"shift-schedule-view\"]')).toBeVisible();\n    \n    // Select a specific shift that needs employee assignment\n    await page.click('[data-testid=\"shift-row\"]:has-text(\"Morning Shift - 08:00 AM\")');\n    \n    // Expected Result: Shift details displayed\n    await expect(page.locator('[data-testid=\"shift-details-panel\"]')).toBeVisible();\n    await expect(page.locator('[data-testid=\"shift-time\"]')).toContainText('08:00 AM');\n    \n    // Step 2: Click on 'Assign Employee' button and select an eligible employee\n    await page.click('[data-testid=\"assign-employee-button\"]');\n    await expect(page.locator('[data-testid=\"employee-list-modal\"]')).toBeVisible();\n    \n    // Review and select an eligible employee from the filtered list\n    await expect(page.locator('[data-testid=\"eligible-employee-item\"]')).toHaveCount(await page.locator('[data-testid=\"eligible-employee-item\"]').count());\n    await page.click('[data-testid=\"eligible-employee-item\"]:has-text(\"John Smith\")');\n    \n    // Expected Result: Employee selected without errors\n    await expect(page.locator('[data-testid=\"selected-employee\"]')).toContainText('John Smith');\n    await expect(page.locator('[data-testid=\"error-message\"]')).not.toBeVisible();\n    \n    // Step 3: Confirm the employee selection and save the assignment\n    await page.click('[data-testid=\"confirm-assignment-button\"]');\n    await page.click('[data-testid=\"save-assignment-button\"]');\n    \n    // Expected Result: Assignment saved with confirmation\n    await expect(page.locator('[data-testid=\"success-message\"]')).toBeVisible();\n    await expect(page.locator('[data-testid=\"success-message\"]')).toContainText('Assignment saved successfully');\n    await expect(page.locator('[data-testid=\"shift-row\"]:has-text(\"Morning Shift - 08:00 AM\")')).toContainText('John Smith');\n  });\n\n  test('Prevent assignment of employee to overlapping shifts', async ({ page }) => {\n    // Step 1: Navigate to shift schedule view and identify an employee already assigned\n    await page.click('[data-testid=\"main-menu\"]');\n    await page.click('[data-testid=\"shift-schedule-link\"]');\n    await expect(page.locator('[data-testid=\"shift-schedule-view\"]')).toBeVisible();\n    \n    // Identify an employee who is already assigned to a shift during a specific time period\n    const assignedShift = page.locator('[data-testid=\"shift-row\"]:has-text(\"Morning Shift - 08:00 AM\")');\n    await expect(assignedShift).toContainText('Jane Doe');\n    \n    // Step 2: Select a different shift that overlaps with the employee's currently assigned shift\n    await page.click('[data-testid=\"shift-row\"]:has-text(\"Extended Morning - 09:00 AM\")');\n    await expect(page.locator('[data-testid=\"shift-details-panel\"]')).toBeVisible();\n    \n    // Attempt to assign the same employee to this overlapping shift\n    await page.click('[data-testid=\"assign-employee-button\"]');\n    await expect(page.locator('[data-testid=\"employee-list-modal\"]')).toBeVisible();\n    await page.click('[data-testid=\"eligible-employee-item\"]', { text: 'Jane Doe' });\n    await page.click('[data-testid=\"confirm-assignment-button\"]');\n    \n    // Expected Result: Validation error displayed preventing assignment\n    await expect(page.locator('[data-testid=\"validation-error\"]')).toBeVisible();\n    await expect(page.locator('[data-testid=\"validation-error\"]')).toContainText('Employee is already assigned to an overlapping shift');\n    \n    // Step 3: Attempt to save assignment changes\n    await page.click('[data-testid=\"save-assignment-button\"]');\n    \n    // Expected Result: Save blocked until conflicts resolved\n    await expect(page.locator('[data-testid=\"save-assignment-button\"]')).toBeDisabled();\n    await expect(page.locator('[data-testid=\"error-message\"]')).toBeVisible();\n    await expect(page.locator('[data-testid=\"error-message\"]')).toContainText('Cannot save assignment with conflicts');\n    \n    // Verify assignment was not saved\n    await page.click('[data-testid=\"cancel-button\"]');\n    await expect(page.locator('[data-testid=\"shift-row\"]:has-text(\"Extended Morning - 09:00 AM\")')).not.toContainText('Jane Doe');\n  });\n});"
    }
  ]
}