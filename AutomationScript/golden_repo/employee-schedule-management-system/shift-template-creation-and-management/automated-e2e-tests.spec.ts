json
{
  "success": true,
  "playwrightTests": [
    {
      "storyId": "story-1",
      "storyTitle": "As Scheduling Manager, I want to create shift templates to achieve consistent shift definitions",
      "testFile": "shift-templates.spec.ts",
      "testCode": "import { test, expect } from '@playwright/test';\n\ntest.describe('Shift Template Management', () => {\n  const BASE_URL = process.env.BASE_URL || 'http://localhost:3000';\n\n  test.beforeEach(async ({ page }) => {\n    // Navigate to the application and ensure user is logged in as Scheduling Manager\n    await page.goto(BASE_URL);\n  });\n\n  test('Validate successful shift template creation with valid data', async ({ page }) => {\n    // Step 1: Navigate to shift template creation page\n    await page.click('text=Shift Templates');\n    await page.click('text=Create New Template');\n    await expect(page.locator('[data-testid=\"shift-template-form\"]')).toBeVisible();\n\n    // Step 2: Enter valid start time, end time, breaks, and roles\n    await page.fill('[data-testid=\"template-name-input\"]', 'Morning Shift');\n    await page.fill('[data-testid=\"start-time-input\"]', '08:00 AM');\n    await page.fill('[data-testid=\"end-time-input\"]', '04:00 PM');\n    \n    // Add break period\n    await page.click('[data-testid=\"add-break-button\"]');\n    await page.fill('[data-testid=\"break-start-time-input\"]', '12:00 PM');\n    await page.fill('[data-testid=\"break-end-time-input\"]', '12:30 PM');\n    \n    // Select roles\n    await page.click('[data-testid=\"roles-dropdown\"]');\n    await page.check('[data-testid=\"role-checkbox-cashier\"]');\n    await page.check('[data-testid=\"role-checkbox-sales-associate\"]');\n    \n    // Verify no validation errors\n    await expect(page.locator('[data-testid=\"validation-error\"]')).not.toBeVisible();\n\n    // Step 3: Submit the form and verify success\n    const responsePromise = page.waitForResponse(response => \n      response.url().includes('/api/shifttemplates') && response.request().method() === 'POST'\n    );\n    \n    await page.click('[data-testid=\"save-template-button\"]');\n    \n    const response = await responsePromise;\n    expect(response.status()).toBe(201);\n    \n    const responseBody = await response.json();\n    expect(responseBody).toHaveProperty('id');\n    expect(responseBody.name).toBe('Morning Shift');\n    \n    // Verify confirmation message\n    await expect(page.locator('[data-testid=\"success-message\"]')).toBeVisible();\n    await expect(page.locator('[data-testid=\"success-message\"]')).toContainText('Template created successfully');\n  });\n\n  test('Reject shift template creation with invalid time data', async ({ page }) => {\n    // Step 1: Navigate to shift template creation page\n    await page.click('text=Shift Templates');\n    await page.click('text=Create New Template');\n    await expect(page.locator('[data-testid=\"shift-template-form\"]')).toBeVisible();\n\n    // Step 2: Enter end time earlier than start time\n    await page.fill('[data-testid=\"template-name-input\"]', 'Invalid Shift');\n    await page.fill('[data-testid=\"start-time-input\"]', '04:00 PM');\n    await page.fill('[data-testid=\"end-time-input\"]', '08:00 AM');\n    \n    // Verify validation error is displayed\n    await expect(page.locator('[data-testid=\"validation-error\"]')).toBeVisible();\n    await expect(page.locator('[data-testid=\"validation-error\"]')).toContainText('End time must be after start time');\n\n    // Step 3: Attempt to submit the form\n    let apiCallMade = false;\n    page.on('request', request => {\n      if (request.url().includes('/api/shifttemplates') && request.method() === 'POST') {\n        apiCallMade = true;\n      }\n    });\n    \n    await page.click('[data-testid=\"save-template-button\"]');\n    \n    // Wait a moment to ensure no API call is made\n    await page.waitForTimeout(1000);\n    expect(apiCallMade).toBe(false);\n    \n    // Verify error messages are still displayed\n    await expect(page.locator('[data-testid=\"validation-error\"]')).toBeVisible();\n    \n    // Correct the end time to valid time\n    await page.fill('[data-testid=\"end-time-input\"]', '08:00 PM');\n    await expect(page.locator('[data-testid=\"validation-error\"]')).not.toBeVisible();\n  });\n\n  test('List existing shift templates', async ({ page }) => {\n    // Step 1: Navigate to shift template management page\n    await page.click('text=Shift Templates');\n    await page.click('text=Manage Templates');\n    \n    // Verify API GET request and response time\n    const startTime = Date.now();\n    const responsePromise = page.waitForResponse(response => \n      response.url().includes('/api/shifttemplates') && response.request().method() === 'GET'\n    );\n    \n    const response = await responsePromise;\n    const responseTime = Date.now() - startTime;\n    \n    expect(response.status()).toBe(200);\n    expect(responseTime).toBeLessThan(2000);\n    \n    const templates = await response.json();\n    expect(Array.isArray(templates)).toBe(true);\n    \n    // Verify list of templates is displayed\n    await expect(page.locator('[data-testid=\"template-list\"]')).toBeVisible();\n    await expect(page.locator('[data-testid=\"template-item\"]').first()).toBeVisible();\n\n    // Step 2: Search for a template by name\n    await page.fill('[data-testid=\"search-box\"]', 'Morning');\n    await page.waitForTimeout(500); // Wait for search debounce\n    \n    const filteredByName = page.locator('[data-testid=\"template-item\"]');\n    await expect(filteredByName).toHaveCount(await filteredByName.count());\n    await expect(filteredByName.first()).toContainText('Morning');\n    \n    // Clear search and search by role\n    await page.fill('[data-testid=\"search-box\"]', '');\n    await page.fill('[data-testid=\"search-box\"]', 'Cashier');\n    await page.waitForTimeout(500);\n    \n    const filteredByRole = page.locator('[data-testid=\"template-item\"]');\n    await expect(filteredByRole.first()).toContainText('Cashier');\n\n    // Step 3: Select a template from the list\n    await page.fill('[data-testid=\"search-box\"]', 'Morning');\n    await page.waitForTimeout(500);\n    await page.click('[data-testid=\"template-item\"]:has-text(\"Morning Shift\")');\n    \n    // Verify template details are displayed\n    await expect(page.locator('[data-testid=\"template-details\"]')).toBeVisible();\n    await expect(page.locator('[data-testid=\"template-name\"]')).toContainText('Morning Shift');\n    await expect(page.locator('[data-testid=\"template-start-time\"]')).toContainText('08:00 AM');\n    await expect(page.locator('[data-testid=\"template-end-time\"]')).toContainText('04:00 PM');\n    await expect(page.locator('[data-testid=\"template-break-start\"]')).toContainText('12:00 PM');\n    await expect(page.locator('[data-testid=\"template-break-end\"]')).toContainText('12:30 PM');\n    await expect(page.locator('[data-testid=\"template-roles\"]')).toContainText('Cashier');\n    await expect(page.locator('[data-testid=\"template-roles\"]')).toContainText('Sales Associate');\n  });\n});"
    }
  ]
}