json
{
  "success": true,
  "playwrightTests": [
    {
      "storyId": "story-3",
      "storyTitle": "As Scheduling Manager, I want to delete shift templates to remove obsolete shifts",
      "testFile": "delete-shift-templates.spec.ts",
      "testCode": "import { test, expect } from '@playwright/test';\n\ntest.describe('Delete Shift Templates', () => {\n  test.beforeEach(async ({ page }) => {\n    // Navigate to the application and login as Scheduling Manager\n    await page.goto('/login');\n    await page.fill('[data-testid=\"username-input\"]', 'scheduling.manager@example.com');\n    await page.fill('[data-testid=\"password-input\"]', 'password123');\n    await page.click('[data-testid=\"login-button\"]');\n    await expect(page).toHaveURL(/.*dashboard/);\n  });\n\n  test('Delete unused shift template successfully', async ({ page }) => {\n    // Step 1: Navigate to shift template list\n    await page.click('[data-testid=\"main-menu\"]');\n    await page.click('text=Shift Templates');\n    await expect(page).toHaveURL(/.*shift-templates/);\n    \n    // Verify templates are displayed\n    await expect(page.locator('[data-testid=\"template-list\"]')).toBeVisible();\n    await expect(page.locator('[data-testid=\"template-item\"]').first()).toBeVisible();\n    \n    // Step 2: Select an unused template and confirm deletion\n    const unusedTemplate = page.locator('[data-testid=\"template-item\"]').filter({ hasText: 'Unused Template' }).first();\n    await expect(unusedTemplate).toBeVisible();\n    \n    // Store template name for verification\n    const templateName = await unusedTemplate.locator('[data-testid=\"template-name\"]').textContent();\n    \n    // Click delete button for the unused template\n    await unusedTemplate.locator('[data-testid=\"delete-template-button\"]').click();\n    \n    // Confirm deletion in dialog\n    await expect(page.locator('[data-testid=\"delete-confirmation-dialog\"]')).toBeVisible();\n    await expect(page.locator('text=Are you sure you want to delete this template?')).toBeVisible();\n    await page.click('[data-testid=\"confirm-delete-button\"]');\n    \n    // Wait for deletion to complete\n    await expect(page.locator('[data-testid=\"success-message\"]')).toBeVisible();\n    await expect(page.locator('text=Template deleted successfully')).toBeVisible();\n    \n    // Step 3: Verify template no longer appears in list\n    await expect(page.locator('[data-testid=\"template-item\"]').filter({ hasText: templateName || '' })).toHaveCount(0);\n    \n    // Refresh page to confirm persistence\n    await page.reload();\n    await expect(page.locator('[data-testid=\"template-list\"]')).toBeVisible();\n    await expect(page.locator('[data-testid=\"template-item\"]').filter({ hasText: templateName || '' })).toHaveCount(0);\n  });\n\n  test('Prevent deletion of shift template assigned to schedules', async ({ page }) => {\n    // Step 1: Navigate to shift template list\n    await page.click('[data-testid=\"main-menu\"]');\n    await page.click('text=Shift Templates');\n    await expect(page).toHaveURL(/.*shift-templates/);\n    \n    // Select a template assigned to schedules\n    const assignedTemplate = page.locator('[data-testid=\"template-item\"]').filter({ hasText: 'Assigned Template' }).first();\n    await expect(assignedTemplate).toBeVisible();\n    await assignedTemplate.click();\n    \n    // Verify template details are displayed\n    await expect(page.locator('[data-testid=\"template-details\"]')).toBeVisible();\n    \n    // Store template name for verification\n    const templateName = await page.locator('[data-testid=\"template-name\"]').textContent();\n    \n    // Step 2: Attempt to delete the assigned template\n    await page.click('[data-testid=\"delete-template-button\"]');\n    \n    // Confirm deletion attempt\n    await expect(page.locator('[data-testid=\"delete-confirmation-dialog\"]')).toBeVisible();\n    await page.click('[data-testid=\"confirm-delete-button\"]');\n    \n    // Step 2 Expected Result: System displays error preventing deletion\n    await expect(page.locator('[data-testid=\"error-message\"]')).toBeVisible();\n    await expect(page.locator('text=Cannot delete template')).toBeVisible();\n    await expect(page.locator('text=assigned to schedules')).toBeVisible();\n    \n    // Close error dialog\n    await page.click('[data-testid=\"close-error-button\"]');\n    await expect(page.locator('[data-testid=\"error-message\"]')).not.toBeVisible();\n    \n    // Step 3: Verify template remains in the list\n    await page.click('[data-testid=\"back-to-list-button\"]');\n    await expect(page.locator('[data-testid=\"template-list\"]')).toBeVisible();\n    await expect(page.locator('[data-testid=\"template-item\"]').filter({ hasText: templateName || '' })).toBeVisible();\n    \n    // Refresh page to confirm template was not deleted\n    await page.reload();\n    await expect(page.locator('[data-testid=\"template-list\"]')).toBeVisible();\n    await expect(page.locator('[data-testid=\"template-item\"]').filter({ hasText: templateName || '' })).toBeVisible();\n  });\n});"
    }
  ]
}