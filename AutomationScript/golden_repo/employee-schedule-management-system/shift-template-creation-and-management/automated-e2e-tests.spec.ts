json
{
  "success": true,
  "playwrightTests": [
    {
      "storyId": "story-2",
      "storyTitle": "As Scheduling Manager, I want to edit existing shift templates to update shift details",
      "testFile": "edit-shift-templates.spec.ts",
      "testCode": "import { test, expect } from '@playwright/test';\n\ntest.describe('Edit Shift Templates - Story 2', () => {\n  test.beforeEach(async ({ page }) => {\n    // Navigate to shift template management page\n    await page.goto('/shift-templates');\n    await page.waitForLoadState('networkidle');\n  });\n\n  test('Edit shift template with valid updated data', async ({ page }) => {\n    // Step 1: Navigate to shift template list\n    await page.click('text=Shift Templates');\n    await page.click('text=Manage Templates');\n    \n    // Expected Result: List of templates displayed\n    await expect(page.locator('[data-testid=\"template-list\"]')).toBeVisible();\n    await expect(page.locator('[data-testid=\"template-item\"]').first()).toBeVisible();\n\n    // Step 2: Select a template and modify start and end times\n    // Locate the 'Morning Shift' template and click Edit\n    const morningShiftRow = page.locator('[data-testid=\"template-item\"]').filter({ hasText: 'Morning Shift' });\n    await morningShiftRow.locator('[data-testid=\"edit-button\"]').click();\n    \n    // Wait for edit form to load\n    await expect(page.locator('[data-testid=\"edit-template-form\"]')).toBeVisible();\n    \n    // Modify start time from 08:00 AM to 07:00 AM\n    const startTimeField = page.locator('[data-testid=\"start-time-input\"]');\n    await startTimeField.clear();\n    await startTimeField.fill('07:00 AM');\n    \n    // Modify end time from 04:00 PM to 05:00 PM\n    const endTimeField = page.locator('[data-testid=\"end-time-input\"]');\n    await endTimeField.clear();\n    await endTimeField.fill('05:00 PM');\n    \n    // Update break period from 12:00 PM - 12:30 PM to 01:00 PM - 01:30 PM\n    const breakStartField = page.locator('[data-testid=\"break-start-input\"]').first();\n    await breakStartField.clear();\n    await breakStartField.fill('01:00 PM');\n    \n    const breakEndField = page.locator('[data-testid=\"break-end-input\"]').first();\n    await breakEndField.clear();\n    await breakEndField.fill('01:30 PM');\n    \n    // Expected Result: Input fields accept changes without errors\n    await expect(startTimeField).toHaveValue('07:00 AM');\n    await expect(endTimeField).toHaveValue('05:00 PM');\n    await expect(breakStartField).toHaveValue('01:00 PM');\n    await expect(breakEndField).toHaveValue('01:30 PM');\n\n    // Step 3: Save the updated template\n    const startTime = Date.now();\n    const responsePromise = page.waitForResponse(response => \n      response.url().includes('/api/shifttemplates/') && response.request().method() === 'PUT'\n    );\n    \n    await page.click('[data-testid=\"save-changes-button\"]');\n    \n    const response = await responsePromise;\n    const endTime = Date.now();\n    const responseTime = endTime - startTime;\n    \n    // Expected Result: Update succeeds with confirmation message\n    // Verify API response status 200\n    expect(response.status()).toBe(200);\n    \n    // Verify response time is within 2 seconds\n    expect(responseTime).toBeLessThan(2000);\n    \n    // Verify confirmation message displayed\n    await expect(page.locator('[data-testid=\"success-message\"]')).toBeVisible();\n    await expect(page.locator('[data-testid=\"success-message\"]')).toContainText('successfully updated');\n    \n    // Navigate back to template list and verify updated times\n    await page.click('[data-testid=\"back-to-list-button\"]');\n    await expect(page.locator('[data-testid=\"template-list\"]')).toBeVisible();\n    \n    const updatedMorningShift = page.locator('[data-testid=\"template-item\"]').filter({ hasText: 'Morning Shift' });\n    await expect(updatedMorningShift).toContainText('07:00 AM');\n    await expect(updatedMorningShift).toContainText('05:00 PM');\n  });\n\n  test('Reject update with invalid break times', async ({ page }) => {\n    // Step 1: Select a shift template to edit\n    // Navigate to template management page\n    await page.click('text=Shift Templates');\n    await page.click('text=Manage Templates');\n    \n    // Locate the 'Evening Shift' template and click Edit\n    const eveningShiftRow = page.locator('[data-testid=\"template-item\"]').filter({ hasText: 'Evening Shift' });\n    await eveningShiftRow.locator('[data-testid=\"edit-button\"]').click();\n    \n    // Expected Result: Template details displayed\n    await expect(page.locator('[data-testid=\"edit-template-form\"]')).toBeVisible();\n    await expect(page.locator('[data-testid=\"template-name\"]')).toContainText('Evening Shift');\n\n    // Step 2: Enter overlapping break periods\n    // Click 'Add Break' button to add a second break period\n    await page.click('[data-testid=\"add-break-button\"]');\n    \n    // Wait for new break fields to appear\n    const breakFields = page.locator('[data-testid=\"break-period\"]');\n    await expect(breakFields).toHaveCount(2);\n    \n    // Enter second break period as 05:15 PM - 05:45 PM (overlapping with existing 05:00 PM - 05:30 PM)\n    const secondBreakStart = page.locator('[data-testid=\"break-start-input\"]').nth(1);\n    const secondBreakEnd = page.locator('[data-testid=\"break-end-input\"]').nth(1);\n    \n    await secondBreakStart.fill('05:15 PM');\n    await secondBreakEnd.fill('05:45 PM');\n    \n    // Expected Result: Validation error displayed for breaks\n    await expect(page.locator('[data-testid=\"validation-error\"]')).toBeVisible();\n    await expect(page.locator('[data-testid=\"validation-error\"]')).toContainText('overlapping');\n\n    // Step 3: Attempt to save changes\n    // Set up request interception to verify no API call is made\n    let apiCallMade = false;\n    page.on('request', request => {\n      if (request.url().includes('/api/shifttemplates/') && request.method() === 'PUT') {\n        apiCallMade = true;\n      }\n    });\n    \n    const saveButton = page.locator('[data-testid=\"save-changes-button\"]');\n    await saveButton.click();\n    \n    // Wait a moment to ensure no API call is triggered\n    await page.waitForTimeout(500);\n    \n    // Expected Result: Save blocked with error messages\n    // Verify no API call was made\n    expect(apiCallMade).toBe(false);\n    \n    // Verify error messages are still displayed\n    await expect(page.locator('[data-testid=\"validation-error\"]')).toBeVisible();\n    await expect(page.locator('[data-testid=\"validation-error\"]')).toContainText('overlapping');\n    \n    // Verify save button is disabled or form is not submitted\n    const errorCount = await page.locator('[data-testid=\"validation-error\"]').count();\n    expect(errorCount).toBeGreaterThan(0);\n    \n    // Correct the second break period to 06:00 PM - 06:30 PM (eliminating overlap)\n    await secondBreakStart.clear();\n    await secondBreakStart.fill('06:00 PM');\n    await secondBreakEnd.clear();\n    await secondBreakEnd.fill('06:30 PM');\n    \n    // Verify validation error is cleared\n    await expect(page.locator('[data-testid=\"validation-error\"]')).not.toBeVisible();\n    \n    // Verify save button is now enabled and form can be submitted\n    await expect(saveButton).toBeEnabled();\n  });\n});"
    }
  ]
}