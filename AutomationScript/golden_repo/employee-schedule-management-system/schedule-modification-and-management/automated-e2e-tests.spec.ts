json
{
  "success": true,
  "playwrightTests": [
    {
      "storyId": "story-6",
      "storyTitle": "As Scheduling Manager, I want to edit employee schedules to update shift assignments",
      "testFile": "edit-employee-schedules.spec.ts",
      "testCode": "import { test, expect } from '@playwright/test';\n\ntest.describe('Edit Employee Schedules', () => {\n  test.beforeEach(async ({ page }) => {\n    // Navigate to the application and login as Scheduling Manager\n    await page.goto('/login');\n    await page.fill('[data-testid=\"username-input\"]', 'scheduling.manager@company.com');\n    await page.fill('[data-testid=\"password-input\"]', 'SecurePass123');\n    await page.click('[data-testid=\"login-button\"]');\n    await expect(page).toHaveURL('/dashboard');\n  });\n\n  test('Edit schedule to update employee assignment successfully', async ({ page }) => {\n    // Step 1: Navigate to schedule view and select shift\n    await page.click('[data-testid=\"schedule-menu-item\"]');\n    await expect(page).toHaveURL('/schedules');\n    await page.waitForSelector('[data-testid=\"schedule-grid\"]');\n    \n    // Select a specific shift from the schedule\n    await page.click('[data-testid=\"shift-card-monday-morning\"]');\n    \n    // Expected Result: Shift details displayed\n    await expect(page.locator('[data-testid=\"shift-details-panel\"]')).toBeVisible();\n    await expect(page.locator('[data-testid=\"shift-time\"]')).toContainText('08:00 - 16:00');\n    await expect(page.locator('[data-testid=\"current-employee-name\"]')).toBeVisible();\n    \n    // Step 2: Change employee assignment to a valid employee\n    await page.click('[data-testid=\"edit-shift-button\"]');\n    await expect(page.locator('[data-testid=\"edit-shift-modal\"]')).toBeVisible();\n    \n    // Click on employee assignment dropdown\n    await page.click('[data-testid=\"employee-assignment-dropdown\"]');\n    await page.waitForSelector('[data-testid=\"employee-option-list\"]');\n    \n    // Select a different valid employee\n    await page.click('[data-testid=\"employee-option-jane-smith\"]');\n    \n    // Expected Result: Input accepted without errors\n    await expect(page.locator('[data-testid=\"validation-error\"]')).not.toBeVisible();\n    await expect(page.locator('[data-testid=\"employee-assignment-dropdown\"]')).toContainText('Jane Smith');\n    \n    // Step 3: Save updated schedule\n    await page.click('[data-testid=\"save-schedule-button\"]');\n    \n    // Expected Result: Update saved with confirmation and audit log entry\n    await expect(page.locator('[data-testid=\"success-message\"]')).toBeVisible();\n    await expect(page.locator('[data-testid=\"success-message\"]')).toContainText('Schedule updated successfully');\n    \n    // Verify the shift now shows the new employee\n    await expect(page.locator('[data-testid=\"current-employee-name\"]')).toContainText('Jane Smith');\n    \n    // Verify audit log entry was created\n    await page.click('[data-testid=\"view-audit-log-button\"]');\n    await expect(page.locator('[data-testid=\"audit-log-entry\"]').first()).toContainText('Schedule modified');\n    await expect(page.locator('[data-testid=\"audit-log-entry\"]').first()).toContainText('Jane Smith');\n  });\n\n  test('Reject schedule update with conflicting employee assignment', async ({ page }) => {\n    // Step 1: Navigate to schedule view and select a shift to edit\n    await page.click('[data-testid=\"schedule-menu-item\"]');\n    await expect(page).toHaveURL('/schedules');\n    await page.waitForSelector('[data-testid=\"schedule-grid\"]');\n    \n    // Select a shift to edit\n    await page.click('[data-testid=\"shift-card-tuesday-morning\"]');\n    await expect(page.locator('[data-testid=\"shift-details-panel\"]')).toBeVisible();\n    \n    // Click edit button\n    await page.click('[data-testid=\"edit-shift-button\"]');\n    await expect(page.locator('[data-testid=\"edit-shift-modal\"]')).toBeVisible();\n    \n    // Step 2: Attempt to assign an employee who is already scheduled for an overlapping time slot\n    await page.click('[data-testid=\"employee-assignment-dropdown\"]');\n    await page.waitForSelector('[data-testid=\"employee-option-list\"]');\n    \n    // Select an employee with conflicting schedule\n    await page.click('[data-testid=\"employee-option-john-doe\"]');\n    \n    // Expected Result: Validation error displayed\n    await expect(page.locator('[data-testid=\"validation-error\"]')).toBeVisible();\n    await expect(page.locator('[data-testid=\"validation-error\"]')).toContainText('Employee is already assigned to an overlapping shift');\n    \n    // Verify conflict details are shown\n    await expect(page.locator('[data-testid=\"conflict-details\"]')).toBeVisible();\n    await expect(page.locator('[data-testid=\"conflict-details\"]')).toContainText('John Doe');\n    await expect(page.locator('[data-testid=\"conflict-details\"]')).toContainText('08:00 - 16:00');\n    \n    // Step 3: Attempt to click the Save button while the conflict exists\n    await page.click('[data-testid=\"save-schedule-button\"]');\n    \n    // Expected Result: Save blocked until conflicts resolved\n    await expect(page.locator('[data-testid=\"validation-error\"]')).toBeVisible();\n    await expect(page.locator('[data-testid=\"validation-error\"]')).toContainText('Cannot save schedule with conflicts');\n    \n    // Verify the save button is disabled or the modal remains open\n    const saveButton = page.locator('[data-testid=\"save-schedule-button\"]');\n    const isDisabled = await saveButton.isDisabled();\n    if (!isDisabled) {\n      // If button is not disabled, modal should still be visible\n      await expect(page.locator('[data-testid=\"edit-shift-modal\"]')).toBeVisible();\n    }\n    \n    // Cancel the edit operation\n    await page.click('[data-testid=\"cancel-edit-button\"]');\n    \n    // Verify that the original schedule remains unchanged\n    await expect(page.locator('[data-testid=\"shift-details-panel\"]')).toBeVisible();\n    await expect(page.locator('[data-testid=\"current-employee-name\"]')).not.toContainText('John Doe');\n    \n    // Verify no audit log entry was created for the failed update\n    await page.click('[data-testid=\"view-audit-log-button\"]');\n    const auditEntries = page.locator('[data-testid=\"audit-log-entry\"]');\n    const count = await auditEntries.count();\n    \n    if (count > 0) {\n      // Verify the most recent entry is not about this failed update\n      await expect(auditEntries.first()).not.toContainText('Tuesday');\n    }\n  });\n});"
    }
  ]
}